<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>{% block title %}Welcome!{% endblock %}</title>
        <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 128 128%22><text y=%221.2em%22 font-size=%2296%22>⚫️</text><text y=%221.3em%22 x=%220.2em%22 font-size=%2276%22 fill=%22%23fff%22>sf</text></svg>">
        {% block stylesheets %}
        {% endblock %}

        {% block javascripts %}
            {% block importmap %}{{ importmap('app') }}{% endblock %}
        {% endblock %}
    </head>
    <body class="bg-gray-100 min-h-screen flex-col">
        {% include('partials/_navbar.html.twig')%}
        {% block body %}{% endblock %}
        {% include('partials/_footer.html.twig')%}

            <script>
                function updateQuantity(id, change) {
                const qtyElement = document.getElementById('qty-' + id);
                const currentQty = parseInt(qtyElement.innerText);
                const newQty = currentQty + change;

                fetch('/cart/update/' + id, {
                    method: 'POST',
                    headers: {
                        'X-Requested-With': 'XMLHttpRequest',
                        'Content-Type': 'application/x-www-form-urlencoded'
                    },
                    body: 'quantity=' + newQty
                })
                .then(res => res.json())
                .then(data => {
                    if (data.success) {
                        if (newQty <= 0) {
                            document.getElementById('item-' + id).remove();
                        } else {
                            qtyElement.innerText = newQty;
                            location.reload();
                        }
                        document.getElementById('cart-count').innerText = data.count;
                        document.getElementById('cart-total').innerText = data.total.toFixed(2);
                    }
                });
            }

                function removeItem(id) {
                fetch('/cart/remove/' + id)
                .then(res => res.json())
                .then(data => {
                    if (data.success) {
                        document.getElementById('item-' + id).remove();
                        document.getElementById('cart-count').innerText = data.count;
                        document.getElementById('cart-total').innerText = data.total.toFixed(2);
                    }
                });
            }
        </script>


    </body>
</html>
